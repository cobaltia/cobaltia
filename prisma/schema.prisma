// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["typedSql", "metrics"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Client {
  id          String   @id @db.VarChar(20)
  bankBalance Decimal  @default(0) @map("bank_balance")
  tax         Decimal  @default(7) @map("tax")
  executives  String[] @default([]) @map("executives")
  ministers   String[] @default([]) @map("ministers")
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @default(now()) @updatedAt @map("updated_at")

  @@map("client")
}

model Guild {
  id               String   @id @db.VarChar(20)
  logChannelId     String?  @map("log_channel_id") @db.VarChar(20)
  welcomeChannelId String?  @map("welcome_channel_id") @db.VarChar(20)
  voiceChannelId   String?  @map("voice_channel_id") @db.VarChar(20)
  welcomeMessage   String   @default("Welcome to {guild}, {user}!") @map("welcome_message")
  createdAt        DateTime @default(now()) @map("created_at")
  updatedAt        DateTime @default(now()) @updatedAt @map("updated_at")

  @@map("guilds")
}

model User {
  id              String            @id @db.VarChar(20)
  bankBalance     Decimal           @default(0) @map("bank_balance")
  bankLimit       Decimal           @default(1000) @map("bank_limit")
  wallet          Decimal           @default(0) @map("wallet")
  bounty          Decimal           @default(0) @map("bounty")
  experience      Int               @default(0) @map("experience")
  level           Int               @default(0) @map("level")
  socialCredit    Int               @default(1000) @map("social_credit")
  createdAt       DateTime          @default(now()) @map("created_at")
  updatedAt       DateTime          @default(now()) @updatedAt @map("updated_at")
  Voice           Voice[]
  BankTransaction BankTransaction[]
  Inventory       Inventory[]

  @@map("users")
}

model Inventory {
  id        String   @id @default(cuid())
  userId    String   @map("user_id") @db.VarChar(20)
  itemId    String   @map("item_id") @db.VarChar(20)
  quantity  Int      @default(0) @map("quantity")
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at")

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, itemId])
  @@map("inventories")
}

model Voice {
  id        String   @id @default(cuid())
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId    String   @map("user_id") @db.VarChar(20)
  channelId String   @map("channel_id") @db.VarChar(20)
  guildId   String   @map("guild_id") @db.VarChar(20)
  date      DateTime @default(now()) @map("date")
  duration  Int      @default(0) @map("duration")
  earned    Decimal  @default(0) @map("earned")
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at")

  @@map("voices")
}

model BankTransaction {
  id          String      @id @default(cuid())
  amount      Decimal     @map("amount")
  type        Transaction @map("type")
  description String[]    @map("description")
  account     User        @relation(fields: [accountId], references: [id], onDelete: Cascade)
  accountId   String      @map("account_id")
  date        DateTime    @default(now()) @map("date")
  createdAt   DateTime    @default(now()) @map("created_at")
  updatedAt   DateTime    @default(now()) @updatedAt @map("updated_at")

  @@map("bank_transactions")
}

model Event {
  id        String   @id @default(cuid())
  name      String   @unique() @map("name")
  enabled   Boolean  @default(false) @map("enabled")
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at")

  @@map("events")
}

enum Transaction {
  DEPOSIT
  WITHDRAW
  TRANSFER
}
